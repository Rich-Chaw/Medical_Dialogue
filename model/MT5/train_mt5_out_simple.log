train_dataset: <__main__.MyDataset object at 0x152c03a82c50>
2023-02-25 10:47:16,466 - INFO - total training steps = 1317
INFO:__main__:total training steps = 1317
2023-02-25 10:47:16,471 - INFO - starting training
INFO:__main__:starting training
input_ids [('<|context|> <|endofcontext|> <|currentuser|> 便秘肠胃消化不良睡眠不好脸上长斑（女，37岁） <|endofcurrentuser|>', '<|context|> <|endofcontext|> <|currentuser|> 吃完大蒜甜醋会感觉下巴跟喉咙很酸是怎么回事（女，16岁） <|endofcurrentuser|>', '<|context|> <|endofcontext|> <|currentuser|> 突发性耳聋引起的晕眩怎么治疗？（女，50岁） <|endofcurrentuser|>', '<|context|> <|endofcontext|> <|currentuser|> 主动脉夹层手术后多久能工作（男，50岁） <|endofcurrentuser|>', '<|context|> <|endofcontext|> <|currentuser|> 气虚乏力气短，二脚无力吃什么好（女，29岁） <|endofcurrentuser|>', '<|context|> <|endofcontext|> <|currentuser|> 便秘严重并且还有混合痔（女，17岁） <|endofcurrentuser|>', '<|context|> <|endofcontext|> <|currentuser|> 双侧锁骨上区多发肿大淋巴结（男，60岁） <|endofcurrentuser|>', '<|context|> <|endofcontext|> <|currentuser|> 请问我老是想解小便是尿路感染吗（女，48岁） <|endofcurrentuser|>'), ('<|intent|> Inform symptom 消化不良  <|continue|> Inform symptom 睡眠障碍   <|endofintent|>', '<|intent|> Inquire pathogeny   <|continue|> Inform symptom 喉咙酸   <|endofintent|>', '<|intent|> Inquire treatment 眩晕  <|continue|> Inform symptom 眩晕  <|continue|> Inform pathogeny 突发性耳聋   <|endofintent|>', '<|intent|> Inquire time 主动脉夹层术后工作时间   <|endofintent|>', '<|intent|> Inquire medicine    <|endofintent|>', '<|intent|> Inform symptom 便秘  <|continue|> Inform symptom 混合痔   <|endofintent|>', '<|intent|> Inform disease 淋巴结肿大   <|endofintent|>', '<|intent|> Inquire disease 尿路感染  <|continue|> Inform symptom 大便频繁   <|endofintent|>')]

inputs {'input_ids': tensor([[  1042,    409,  38541,    409,    669,   1042,    409,   4892,    367,
          38541,    409,    669,   1042,    409,  17265,   7197,    409,    669,
            259, 217391, 164636,  98400, 136068, 100699, 119014, 119104, 208711,
           4898, 143344,    312,   6043,    261,   5819,  27622,    271,   1042,
            409,   4892,    367,  17265,   7197,    409,    669,      1,      0,
              0,      0,      0,      0,      0,      0,      0,      0],
        [  1042,    409,  38541,    409,    669,   1042,    409,   4892,    367,
          38541,    409,    669,   1042,    409,  17265,   7197,    409,    669,
            259,  14296,  22469,   1146, 229345,  71255, 238902,   2219,  84508,
           2446,  14468,  18475, 159004, 242562,  10559,  23592,   1543,   7427,
           3917,   4417,    312,   6043,    261,   1439,  27622,    271,   1042,
            409,   4892,    367,  17265,   7197,    409,    669,      1],
        [  1042,    409,  38541,    409,    669,   1042,    409,   4892,    367,
          38541,    409,    669,   1042,    409,  17265,   7197,    409,    669,
            259,  38432,   5685,   3236,  32173, 241624, 114737,    493, 221282,
         239224,   7427, 109263,  65606,   6043,    261,   1970,  27622,    271,
           1042,    409,   4892,    367,  17265,   7197,    409,    669,      1,
              0,      0,      0,      0,      0,      0,      0,      0],
        [  1042,    409,  38541,    409,    669,   1042,    409,   4892,    367,
          38541,    409,    669,   1042,    409,  17265,   7197,    409,    669,
            259, 101809, 117723, 125536,  29381, 163963,   3592, 102832,   4989,
           6573,    312,  11323,    261,   1970,  27622,    271,   1042,    409,
           4892,    367,  17265,   7197,    409,    669,      1,      0,      0,
              0,      0,      0,      0,      0,      0,      0,      0],
        [  1042,    409,  38541,    409,    669,   1042,    409,   4892,    367,
          38541,    409,    669,   1042,    409,  17265,   7197,    409,    669,
            259,  11755,  56520, 138737,   3862,  11755,  19583,    261,   3178,
          21261,   5941,   3862,  14296,  16892,   3586,    312,   6043,    261,
           2126,  27622,    271,   1042,    409,   4892,    367,  17265,   7197,
            409,    669,      1,      0,      0,      0,      0,      0],
        [  1042,    409,  38541,    409,    669,   1042,    409,   4892,    367,
          38541,    409,    669,   1042,    409,  17265,   7197,    409,    669,
            259, 217391,  82043,  79628,  36017,  97693, 241108,    312,   6043,
            261,   1653,  27622,    271,   1042,    409,   4892,    367,  17265,
           7197,    409,    669,      1,      0,      0,      0,      0,      0,
              0,      0,      0,      0,      0,      0,      0,      0],
        [  1042,    409,  38541,    409,    669,   1042,    409,   4892,    367,
          38541,    409,    669,   1042,    409,  17265,   7197,    409,    669,
            259,  13585,  78450,  79932,  22668,   1644,   3411,   3139,   5685,
         187782,   1146, 140353,  14468,  22312,    312,  11323,    261,   2886,
          27622,    271,   1042,    409,   4892,    367,  17265,   7197,    409,
            669,      1,      0,      0,      0,      0,      0,      0],
        [  1042,    409,  38541,    409,    669,   1042,    409,   4892,    367,
          38541,    409,    669,   1042,    409,  17265,   7197,    409,    669,
            259, 188847,   3003,   5991,   1543,   8813,  10507,   2144, 160443,
          78772,   5070,  74380,   5674,    312,   6043,    261,   4317,  27622,
            271,   1042,    409,   4892,    367,  17265,   7197,    409,    669,
              1,      0,      0,      0,      0,      0,      0,      0]],
       device='cuda:0'), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
         0, 0, 0, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0,
         0, 0, 0, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         0, 0, 0, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
         0, 0, 0, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
         0, 0, 0, 0, 0]], device='cuda:0')}

        
dialogue_inputs: [' <|context|> <|endofcontext|> <|currentuser|> 怎么检查是不是有艾滋病呢（女，23岁） <|endofcurrentuser|> ']
inputs in generation: {'input_ids': tensor([[  1042,    409,  38541,    409,    669,   1042,    409,   4892,    367,
          38541,    409,    669,   1042,    409,  17265,   7197,    409,    669,
            259,   7427,  65427,  84025,   1637,  70365, 119627,  14469,  29518,
            312,   6043,    261,   2116,  27622,    271,   1042,    409,   4892,
            367,  17265,   7197,    409,    669,      1]], device='cuda:0'), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]],
       device='cuda:0')}
outputs: tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0]], device='cuda:0')
generation                                                                                                                                                                                                        
groundtruth:  <|intent|> Inquire check_item   <|endofintent|>  <|knowledge|>  <|endofknowledge|> <|action|> Inform check_item 血常规检查  <|continue|> Inform time 抽血化验前的时间 4至6周 <|endofaction|> <|response|> 危险接触后4-6周去医院抽血化验。 <|endofresponse|>  

dialogue_dict: {'0': {'target_intent': [' Inform symptom 沉沉的  <|continue|> Inform symptom 火辣辣的  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '1': {'target_intent': [' Inform range_body 右前腰部  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '2': {'target_intent': [' Inform symptom 胃炎感觉  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '3': {'target_intent': [' Inform range_body 右腰  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '4': {'target_intent': [' Inform check_item 腹部ct  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '5': {'target_intent': [' Chitchat    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '6': {'target_intent': [' Chitchat    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '7': {'target_intent': [' Chitchat    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '8': {'target_intent': [' Inquire treatment 耳鸣  <|continue|> Inform disease 肾虚耳鸣  <|continue|> Inform medicine 丙戊酸钠  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '9': {'target_intent': [' Inform time 发作时间 两三月，有一年 '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '10': {'target_intent': [' Inform effect 服药 有一点效果，但没有好 <|continue|> Inform treatment 继续服药  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '11': {'target_intent': [' Inform degree 发病程度 又厉害了 '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '12': {'target_intent': [' Inform other 避免熬夜 不 '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '13': {'target_intent': [' QuestionAnswering    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '14': {'target_intent': [' Inform medicine 丙戊酸钠  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '15': {'target_intent': [' Other    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '16': {'target_intent': [' Other    <|continue|> Other    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '17': {'target_intent': [' Other    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '18': {'target_intent': [' Chitchat    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '19': {'target_intent': [' Inquire disease 膀胱过度活动症  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '20': {'target_intent': [' Inform symptom 焦虑睡不好  <|continue|> Inform symptom 腹部胀痛  <|continue|> Inform symptom 尿频  <|continue|> Inform symptom 上厕所频繁  <|continue|> Chitchat    <|continue|> Chitchat    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '21': {'target_intent': [' Inform other 性别  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '22': {'target_intent': [' Inform check_item B超检查  <|continue|> Inform check_item 尿常规检查  <|continue|> Inform time 持续时间 两个月 <|continue|> Inform symptom 尿频  <|continue|> Inform disease_history 尿道炎  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '23': {'target_intent': [' Inform check_item   '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '24': {'target_intent': [' Inform other 不知道  <|continue|> Chitchat    <|continue|> Chitchat    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '25': {'target_intent': [' QuestionAnswering    <|continue|> Inform symptom 咳嗽咳出尿  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '26': {'target_intent': [' QuestionAnswering    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '27': {'target_intent': [' Chitchat    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '28': {'target_intent': [' Inform disease 踝扭伤  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '29': {'target_intent': [' Inform time 扭伤时间 七个小时 <|continue|> Inform check_item ct 没事 <|continue|> Inform degree 疼痛程度 睡不着觉 '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '30': {'target_intent': [' Inform symptom 不动也疼  <|continue|> Inform degree 疼痛程度 刺骨的疼 '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '31': {'target_intent': [' Other    <|continue|> Chitchat    <|continue|> Inform symptom 脚踝肿  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '32': {'target_intent': [' Inform degree 疼痛程度 疼得睡不着觉 <|continue|> Inform effect 冰敷 效果不好 <|continue|> Inform effect 冰敷 效果不好 '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '33': {'target_intent': [' Inquire effect 非甾体消炎药  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '34': {'target_intent': [' Inquire treatment 脚踝扭伤  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '35': {'target_intent': [' Other    <|continue|> Other    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '36': {'target_intent': [' Chitchat    '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '37': {'target_intent': [' Chitchat    <|continue|> Chitchat    <|continue|> Inquire pathogeny 骨头疼  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '38': {'target_intent': [' Other    <|continue|> Inform symptom 疼的厉害  <|continue|> Inquire range_body 受伤部位  '], 'generated_intent': [' '], 'target_action': [], 'generated_action': [' '], 'target_response': [], 'generated_response': [' ']}, '39': {'target_intent': [], 'generated_intent': [], 'target_action': [], 'generated_action': [], 'target_response': [], 'generated_response': []}}
count: 39